<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>資產管理控制台 | Asset Control Center</title>
    <!-- 引入 Tailwind CSS 進行快速現代化樣式開發 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 FontAwesome 提升圖標質感 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 引入 Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+TC:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        /* 自定義動畫與特效 */
        :root {
            --neon-blue: #06b6d4;
            --neon-purple: #8b5cf6;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            background-color: #0f172a;
            background-image: 
                radial-gradient(at 0% 0%, rgba(139, 92, 246, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 0%, rgba(6, 182, 212, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(15, 23, 42, 1) 0px, transparent 50%);
            background-attachment: fixed;
            font-family: 'Noto Sans TC', sans-serif;
            color: #e2e8f0;
        }

        .font-tech {
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }

        /* 毛玻璃卡片特效 */
        .tech-card {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        /* 光暈流動效果 */
        .tech-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.05),
                transparent
            );
            transition: 0.5s;
            pointer-events: none;
        }

        .tech-card:hover::before {
            left: 100%;
        }

        .tech-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(6, 182, 212, 0.5);
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.2), inset 0 0 10px rgba(6, 182, 212, 0.05);
        }

        .tech-card:active {
            transform: scale(0.98);
        }

        /* 報廢卡片的特殊樣式 (警示) */
        .card-danger:hover {
            border-color: rgba(239, 68, 68, 0.5);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.2);
        }
        .card-danger .icon-box {
            color: #f87171;
        }
        .card-danger:hover .icon-box {
            text-shadow: 0 0 10px rgba(239, 68, 68, 0.6);
        }

        /* 圖標容器特效 */
        .icon-box {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 64px;
            height: 64px;
            font-size: 1.75rem;
            color: var(--neon-blue);
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .tech-card:hover .icon-box {
            transform: scale(1.1) rotate(5deg);
            background: rgba(6, 182, 212, 0.1);
            color: #22d3ee;
            text-shadow: 0 0 10px var(--neon-blue);
        }

        /* 通知紅點動畫 */
        .pulse-badge {
            animation: pulse-red 2s infinite;
        }

        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        /* 載入遮罩 */
        #loader-overlay {
            backdrop-filter: blur(5px);
            background: rgba(15, 23, 42, 0.8);
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col items-center py-10 px-4">

    <!-- 頂部標題區 -->
    <header class="text-center mb-10 max-w-4xl w-full relative z-10">
        <div class="inline-block mb-2 px-3 py-1 rounded-full border border-cyan-500/30 bg-cyan-500/10 text-cyan-300 text-xs tracking-widest font-tech">
            Taiwan Biobnak
        </div>
        <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-400 mb-3 font-tech drop-shadow-lg">
            ASSET CONTROL
        </h1>
        <p class="text-slate-400 text-lg tracking-wide font-light">
            財產管理與追蹤
        </p>
    </header>

    <!-- 主要功能網格 -->
    <main class="w-full max-w-6xl grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 relative z-10">

        <!-- 1. 電腦狀態回報 -->
        <div class="tech-card rounded-2xl p-6 cursor-pointer group" onclick="navigateTo('report')">
            <div class="flex flex-col items-center text-center">
                <div class="icon-box">
                    <i class="fa-solid fa-laptop-medical"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-cyan-300 transition-colors">電腦狀態回報</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    定期回報硬體健康數據，<br>確保資產運作效能。
                </p>
            </div>
        </div>

        <!-- 2. 申請財產轉移 -->
        <div class="tech-card rounded-2xl p-6 cursor-pointer group" onclick="navigateTo('apply')">
            <div class="flex flex-col items-center text-center">
                <div class="icon-box">
                    <i class="fa-solid fa-arrow-right-arrow-left"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-cyan-300 transition-colors">申請財產轉移</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    發起資產移交程序，<br>變更保管人權限。
                </p>
            </div>
        </div>

        <!-- 3. 接收待轉移財產 (含通知) -->
        <div id="review-card" class="tech-card rounded-2xl p-6 cursor-pointer group relative" onclick="navigateTo('review')">
            <!-- 通知徽章 -->
            <div id="review-badge" class="hidden absolute top-4 right-4 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full pulse-badge z-20">
                0
            </div>
            <div class="flex flex-col items-center text-center">
                <div class="icon-box">
                    <i class="fa-solid fa-file-signature"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-cyan-300 transition-colors">接收待轉移財產</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    簽核接收他人移交之資產，<br>確認財產歸屬。
                </p>
            </div>
        </div>

        <!-- 4. 申請財產出借 -->
        <div class="tech-card rounded-2xl p-6 cursor-pointer group" onclick="navigateTo('lending')">
            <div class="flex flex-col items-center text-center">
                <div class="icon-box">
                    <i class="fa-solid fa-hand-holding-hand"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-cyan-300 transition-colors">申請財產出借</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    登記短期資產外借，<br>追蹤流向與歸期。
                </p>
            </div>
        </div>

        <!-- 5. 歸還作業管理 -->
        <div class="tech-card rounded-2xl p-6 cursor-pointer group" onclick="navigateTo('return')">
            <div class="flex flex-col items-center text-center">
                <div class="icon-box">
                    <i class="fa-solid fa-box-open"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-cyan-300 transition-colors">歸還作業管理</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    確認資產歸還入庫，<br>結案出借紀錄。
                </p>
            </div>
        </div>

        <!-- 6. 申請財產報廢 (危險操作) -->
        <div class="tech-card card-danger rounded-2xl p-6 cursor-pointer group" onclick="navigateTo('scrap')">
            <div class="flex flex-col items-center text-center">
                <div class="icon-box">
                    <i class="fa-solid fa-trash-can"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-red-300 transition-colors">申請財產報廢</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    針對老舊或損壞資產，<br>提交除帳申請程序。
                </p>
            </div>
        </div>

        <!-- 7. 列印報廢單 -->
        <div class="tech-card rounded-2xl p-6 cursor-pointer group" onclick="navigateTo('printScrap')">
            <div class="flex flex-col items-center text-center">
                <div class="icon-box">
                    <i class="fa-solid fa-print"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-cyan-300 transition-colors">列印報廢單</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    調閱歷史紀錄，<br>產出標準化紙本單據。
                </p>
            </div>
        </div>

        <!-- 8. 列印轉移記錄 -->
        <div class="tech-card rounded-2xl p-6 cursor-pointer group" onclick="navigateTo('printTransfer')">
            <div class="flex flex-col items-center text-center">
                <div class="icon-box">
                    <i class="fa-solid fa-file-export"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-cyan-300 transition-colors">列印轉移記錄</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    產生財產轉移報表，<br>追蹤資產移交紀錄。
                </p>
            </div>
        </div>

        <!-- 9. 更新上傳狀態 (管理員) -->
        <div class="tech-card rounded-2xl p-6 cursor-pointer group" onclick="navigateTo('update')">
            <div class="flex flex-col items-center text-center">
                <div class="icon-box">
                    <i class="fa-solid fa-cloud-arrow-up"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-cyan-300 transition-colors">更新上傳狀態</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    管理員專用功能，<br>同步系統最新狀態。
                </p>
            </div>
        </div>

        <!-- 10. 查詢名下財產 -->
        <div class="tech-card rounded-2xl p-6 cursor-pointer group col-span-1 md:col-span-2 lg:col-span-1" onclick="navigateTo('userstate')">
            <div class="flex flex-col items-center text-center">
                <div class="icon-box bg-gradient-to-br from-cyan-500/20 to-blue-500/20 !text-cyan-200">
                    <i class="fa-solid fa-user-shield"></i>
                </div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-cyan-300 transition-colors">名下財產總覽</h3>
                <p class="text-sm text-slate-400 leading-relaxed">
                    即時查詢個人保管資產，<br>掌握目前詳細狀態。
                </p>
            </div>
        </div>

    </main>

    <footer class="mt-12 text-slate-600 text-xs font-tech">
        SECURE CONNECTION ESTABLISHED • INTERNAL USE ONLY
    </footer>

    <!-- Loading 遮罩 -->
    <div id="loader-overlay" class="fixed inset-0 z-50 hidden flex items-center justify-center flex-col">
        <div class="w-16 h-16 border-4 border-cyan-500/30 border-t-cyan-400 rounded-full animate-spin mb-4"></div>
        <p class="text-cyan-300 font-tech tracking-widest text-sm animate-pulse">PROCESSING REQUEST...</p>
    </div>

    <script>
        let webAppUrl = '';
        const loader = document.getElementById('loader-overlay');

        document.addEventListener("DOMContentLoaded", function() {
            // 模擬載入動畫，增加科技感
            if (typeof google !== 'undefined' && google.script) {
                google.script.run.withSuccessHandler(url => { webAppUrl = url; }).getAppUrl();
                google.script.run.withSuccessHandler(updateReviewBadge).countPendingApprovals();
            } else {
                console.log("Local testing mode");
                // 本地測試用
                webAppUrl = '#'; 
                updateReviewBadge(3); 
            }
        });

        function navigateTo(page) {
            if (webAppUrl) {
                // 顯示載入遮罩
                loader.classList.remove('hidden');
                loader.classList.add('flex');
                
                setTimeout(() => {
                     window.open(webAppUrl + '?page=' + page, '_top');
                }, 300); // 稍微延遲以展示互動效果
            } else {
                // 使用更現代的 Alert 替代方案 (此處簡單使用 alert，建議未來可改為 Toast)
                alert('系統初始化中，請稍候...');
            }
        }

        function updateReviewBadge(count) {
            const badge = document.getElementById('review-badge');
            const card = document.getElementById('review-card');
            
            if (count > 0) {
                badge.textContent = count;
                badge.classList.remove('hidden');
                // 如果有通知，該卡片邊框增加紅色呼吸燈效果
                card.style.borderColor = 'rgba(239, 68, 68, 0.4)';
                card.style.boxShadow = '0 0 15px rgba(239, 68, 68, 0.15)';
            } else {
                badge.classList.add('hidden');
                card.style.borderColor = '';
                card.style.boxShadow = '';
            }
        }
    </script>
</body>
</html>
